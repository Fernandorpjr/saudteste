<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flor - Recepcionista Virtual USF Apipucos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f1f5f9 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            line-height: 1.6;
            color: #334155;
        }

        .container {
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.08),
                0 8px 32px rgba(0, 0, 0, 0.06),
                0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 0;
            max-width: 900px;
            width: 100%;
            overflow: hidden;
            border: 1px solid rgba(226, 232, 240, 0.8);
        }

        .header {
            background: linear-gradient(135deg, #1e40af 0%, #1d4ed8 50%, #2563eb 100%);
            color: white;
            padding: 32px 40px;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 20px rgba(30, 64, 175, 0.15);
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 15px;
        }

        .logo-container {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo-placeholder {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .logo-placeholder:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .logo-placeholder.has-logo {
            border: 2px solid rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.1);
        }

        .logo-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 6px;
        }

        .logo-upload {
            display: none;
        }

        .logo-label {
            font-size: 0.8em;
            color: rgba(255, 255, 255, 0.8);
            text-align: center;
        }

        .avatar {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 45px;
            animation: gentlePulse 3s ease-in-out infinite alternate;
            box-shadow: 
                0 8px 32px rgba(251, 191, 36, 0.3),
                0 4px 16px rgba(245, 158, 11, 0.2);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }

        @keyframes gentlePulse {
            0% { transform: scale(1) rotate(0deg); }
            100% { transform: scale(1.03) rotate(1deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 12px;
            font-weight: 600;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            opacity: 0.95;
            font-size: 1.15em;
            font-weight: 400;
            margin-bottom: 8px;
        }

        .status {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: 500;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-content {
            flex: 1;
            position: relative;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #10b981;
            animation: blink 1.5s ease-in-out infinite alternate;
        }

        .status-indicator.listening {
            background: #ef4444;
            animation: fastBlink 0.5s ease-in-out infinite alternate;
        }

        @keyframes blink {
            0% { opacity: 1; }
            100% { opacity: 0.3; }
        }

        @keyframes fastBlink {
            0% { opacity: 1; }
            100% { opacity: 0.1; }
        }

        .chat-container {
            padding: 32px 40px;
            background: #fafafa;
            min-height: 500px;
        }

        .messages {
            height: 420px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            background: #ffffff;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.02);
        }

        .message {
            margin-bottom: 20px;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            text-align: right;
        }

        .message.bot {
            text-align: left;
        }

        .message-content {
            display: inline-block;
            max-width: 75%;
            padding: 14px 20px;
            border-radius: 18px;
            font-size: 0.98em;
            line-height: 1.5;
            font-weight: 400;
        }

        .user .message-content {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25);
        }

        .bot .message-content {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }

        .message-sender {
            font-size: 0.82em;
            margin: 6px 0;
            opacity: 0.7;
            font-weight: 500;
        }

        .input-container {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .input-field {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 28px;
            font-size: 1em;
            outline: none;
            transition: all 0.3s ease;
            background: #ffffff;
            font-weight: 400;
        }

        .input-field:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .input-field::placeholder {
            color: #94a3b8;
        }

        .btn {
            padding: 16px 24px;
            border: none;
            border-radius: 28px;
            font-size: 0.98em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 140px;
            justify-content: center;
            letter-spacing: 0.01em;
        }

        .btn-send {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-voice {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .btn-voice.listening {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            animation: gentlePulse 2s ease-in-out infinite;
            box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .welcome-message {
            text-align: center;
            color: #64748b;
            font-style: normal;
            padding: 24px;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 16px;
            margin-bottom: 24px;
            border: 1px solid #bae6fd;
            font-weight: 400;
        }

        .welcome-message p {
            margin-bottom: 8px;
        }

        .welcome-message strong {
            color: #1e40af;
            font-weight: 600;
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
            color: #64748b;
            font-style: italic;
            font-weight: 400;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: #64748b;
            animation: typingDots 1.6s ease-in-out infinite;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDots {
            0%, 60%, 100% { 
                transform: translateY(0); 
                opacity: 0.4;
            }
            30% { 
                transform: translateY(-8px); 
                opacity: 1;
            }
        }

        .quick-questions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }

        .quick-question {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 14px 18px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            font-weight: 500;
            color: #475569;
        }

        .quick-question:hover {
            background: #f8fafc;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e1;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                margin: 0;
                border-radius: 20px;
                max-width: 100%;
            }
            
            .header {
                padding: 24px 20px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .avatar {
                width: 75px;
                height: 75px;
                font-size: 38px;
            }
            
            .logo-section {
                flex-direction: column;
                gap: 15px;
            }
            
            .logo-container {
                order: 3;
            }
            
            .header-content {
                order: 1;
            }
            
            .chat-container {
                padding: 20px;
            }
            
            .messages {
                height: 350px;
                padding: 20px;
            }
            
            .input-container {
                flex-direction: column;
                gap: 12px;
            }
            
            .btn {
                width: 100%;
                padding: 14px 20px;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .quick-questions {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 10px;
            }
            
            .quick-question {
                padding: 12px 14px;
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div class="logo-container">
                    <div class="logo-placeholder" id="mainLogo" onclick="document.getElementById('mainLogoInput').click()">
                        <span>üè•</span>
                    </div>
                    <input type="file" id="mainLogoInput" class="logo-upload" accept="image/*" onchange="handleLogoUpload(this, 'mainLogo')">
                    <div class="logo-label">Logo USF</div>
                </div>
                <div class="header-content">
                    <div class="status">
                        <div class="status-indicator" id="statusIndicator"></div>
                        <span id="statusText">Online</span>
                    </div>
                    <div class="avatar">üå∏</div>
                    <h1>Flor</h1>
                    <p>Recepcionista Virtual - USF Apipucos</p>
                </div>
                <div class="logo-container">
                    <div class="logo-placeholder" id="secondaryLogo" onclick="document.getElementById('secondaryLogoInput').click()">
                        <span>üèõÔ∏è</span>
                    </div>
                    <input type="file" id="secondaryLogoInput" class="logo-upload" accept="image/*" onchange="handleLogoUpload(this, 'secondaryLogo')">
                    <div class="logo-label">Logo Prefeitura</div>
                </div>
            </div>
        </div>
        
        <div class="chat-container">
            <div class="welcome-message">
                <p>üëã <strong>Bem-vindo(a) √† USF Apipucos!</strong></p>
                <p>Eu sou a <strong>Flor</strong>, sua assistente virtual. Estou aqui para orient√°-lo(a) com carinho sobre nossos servi√ßos de sa√∫de.</p>
                <p>üí¨ Digite sua pergunta abaixo ou diga <strong>"Oi Flor"</strong> para conversar comigo por voz!</p>
                <p style="font-size: 0.9em; margin-top: 12px; opacity: 0.8;">üïí Atendimento 24h ‚Ä¢ üè• SUS ‚Ä¢ üå∏ Atendimento Humanizado</p>
            </div>
            
            <div class="quick-questions">
                <div class="quick-question" onclick="askQuestion('Qual √© o endere√ßo da USF?')">üìç Endere√ßo</div>
                <div class="quick-question" onclick="askQuestion('Qual √© o telefone?')">üìû Telefone</div>
                <div class="quick-question" onclick="askQuestion('Qual √© o hor√°rio de funcionamento?')">‚è∞ Hor√°rio</div>
                <div class="quick-question" onclick="askQuestion('Que servi√ßos voc√™s oferecem?')">üè• Servi√ßos</div>
                <div class="quick-question" onclick="askQuestion('Quais s√£o os m√©dicos?')">üë®‚Äç‚öïÔ∏è M√©dicos</div>
                <div class="quick-question" onclick="askQuestion('Quais s√£o os agentes de sa√∫de?')">üë• Agentes</div>
                <div class="quick-question" onclick="askQuestion('Onde √© a vacina?')">üíâ Local Vacina</div>
                <div class="quick-question" onclick="askQuestion('Tem dentista?')">ü¶∑ Dentista</div>
                <div class="quick-question" onclick="askQuestion('O que √© o SUS?')">üè• SUS</div>
                <div class="quick-question" onclick="askQuestion('O que √© o SISREG?')">üìä SISREG</div>
                <div class="quick-question" onclick="askQuestion('O que √© hipertens√£o?')">‚ù§Ô∏è Press√£o</div>
                <div class="quick-question" onclick="askQuestion('Como agendar consulta?')">üìÖ Agendamento</div>
            </div>
            
            <div class="messages" id="messages">
            </div>
            
            <div class="typing-indicator" id="typingIndicator">
                <span>Flor est√° digitando</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
            
            <div class="input-container">
                <input type="text" id="userInput" class="input-field" placeholder="Digite sua pergunta aqui..." onkeypress="handleKeyPress(event)">
                <button class="btn btn-send" onclick="sendMessage()">
                    <span>üì§</span>
                    Enviar
                </button>
            </div>
            
            <div class="controls">
                <button class="btn btn-voice" id="voiceBtn" onclick="toggleVoiceRecognition()">
                    <span id="voiceIcon">üé§</span>
                    <span id="voiceText">Ativar Voz</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let recognition = null;
        let isListening = false;
        let continuousListening = false;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;

        // Base de conhecimento da USF Apipucos
        const knowledge = {
            // Informa√ß√µes b√°sicas
            endereco: "Rua Professor Jos√© de Barros, 123, Apipucos, Recife - PE",
            telefone: "(81) 99999-9999",
            email: "usf.apipucos@recife.pe.gov.br",
            horario: "Segunda a sexta-feira, das 7h √†s 17h",
            
            // Equipes por dia
            equipes: {
                segunda: "Dr. Felipe Jacobovitz (Cl√≠nico Geral), Dr. Carmem Ver√¥nica, Dr. Clariana Falc√£o, Ag. Doca (Manh√£) / Dr. Marcos Augusto (Cl√≠nico Geral), Dr. Th√°cia Bezerra, Dr. Loala, Ag. Maria Silva (Tarde)",
                terca: "Dr. Rubens Cavalcanti (Pediatria), Dr. Sabrynna Mayara, Dr. S√¢nia, Ag. Jo√£o Pereira (Manh√£) / Dr. Felipe Jacobovitz (Cl√≠nico Geral), Dr. Carmem Ver√¥nica, Dr. Clariana Falc√£o, Ag. Ana Costa (Tarde)",
                quarta: "Dr. Marcos Augusto (Cl√≠nico Geral), Dr. Th√°cia Bezerra, Dr. Loala, Ag. Paulo Souza (Manh√£) / Dr. Felipe Jacobovitz (Cl√≠nico Geral), Dr. Carmem Ver√¥nica, Dr. Clariana Falc√£o, Ag. Maria Silva (Tarde)",
                quinta: "Dr. Felipe Jacobovitz (Cl√≠nico Geral), Dr. Carmem Ver√¥nica, Dr. Clariana Falc√£o, Ag. Ana Costa (Manh√£) / Dr. Marcos Augusto (Cl√≠nico Geral), Dr. Th√°cia Bezerra, Dr. Loala, Ag. Maria Silva (Tarde)",
                sexta: "Dr. Rubens Cavalcanti (Pediatria), Dr. Sabrynna Mayara, Dr. S√¢nia, Ag. Jo√£o Pereira (Manh√£) / Dr. Marcos Augusto (Cl√≠nico Geral), Dr. Th√°cia Bezerra, Dr. Loala, Ag. Paulo Souza (Tarde)"
            },
            
            // M√©dicos por turno
            medicos: {
                primeiro: "Dr. Felipe Jacobovitz (8h √†s 12h), Dr. Rubens Cavalcanti (8h √†s 12h), Dr. Marcos Augusto (8h √†s 12h)",
                segundo: "Dr. Marcos Augusto (13h √†s 17h), Dr. Felipe Jacobovitz (13h √†s 17h)"
            },
            
            // Servi√ßos
            servicos: [
                "Aten√ß√£o prim√°ria √† sa√∫de",
                "Consultas m√©dicas (cl√≠nico geral e pediatria)",
                "Imuniza√ß√£o (vacinas)",
                "Coleta de material biol√≥gico (exames)",
                "Pr√©-natal",
                "Sa√∫de da fam√≠lia",
                "Eletrocardiograma",
                "Medi√ß√£o de press√£o arterial",
                "Teste de glicemia"
            ],
            
            // Exames
            exames: {
                horario: "Ter√ßa e quinta-feira, das 7h √†s 11h",
                tipos: ["Exames de sangue (jejum de 12h)", "Exames de urina", "Eletrocardiograma", "Medi√ß√£o de press√£o arterial", "Teste de glicemia"],
                documentos: "Pedido m√©dico e documento de identidade"
            },
            
            // Vacina√ß√£o
            vacinacao: {
                dias: "Quarta e quinta-feira, das 10h √†s 16h",
                tipos: ["Vacinas de rotina (crian√ßas e adultos)", "Vacina da gripe", "Vacina COVID-19", "Vacina HPV (adolescentes)"],
                documentos: "Cart√£o de vacina e documento de identidade"
            },
            
            // Agendamento
            agendamento: {
                como: "Por telefone (81) 99999-9999 ou presencialmente na recep√ß√£o",
                horario: "7h √†s 16h",
                documentos: "CPF, RG, Cart√£o SUS",
                chegada: "15 minutos de anteced√™ncia"
            },
            
            // Informa√ß√µes espec√≠ficas da equipe
            equipeEspecifica: {
                clariana: "Dra. Clariana est√° todas as quartas-feiras √† tarde para fazer preven√ß√£o. Voc√™ pode vir por ordem de chegada ou agendamento.",
                jorge: "Quem faz o regulamento √© o senhor Jorge, gente muito boa e educada.",
                wellington: "O vigia √© o Wellington, ele apoia mais do que vigia.",
                rubens: "O m√©dico da manh√£ √© Dr. Rubens. Ele atende por ordem de chegada.",
                fernando: "Fernando Rocha est√° aprendendo recep√ß√£o e eu estou ajudando ele.",
                niedja: "A gestora √© Niedja.",
                carmem: "Para vacina e coleta de sangue, v√° na primeira porta √† direita e fale com Dra. Carmen.",
                loala: "Para atendimento dentista, tem que ser agendamento com a Dra. e cirurgi√£ dentista Loala.",
                marcos: "O cl√≠nico geral da tarde √© Dr. Marcos Augusto. O agendamento tem que ser com agente de sa√∫de ou por ordem de chegada.",
                bruno: "O diretor do terceiro distrito √© Bruno de Luna.",
                joao: "O prefeito do Recife √© Jo√£o Campos.",
                residentes: "Os m√©dicos residentes s√£o Dra. Sabrina e Dr. Felipe."
            },
            
            // Agentes de sa√∫de para acolhimento na sede
            agentesAcolhimento: {
                geral: "O acolhimento √© feito pelo agente de sa√∫de.",
                segunda: "Na segunda-feira, o agente Doca fica na sede para acolhimento.",
                terca: "Na ter√ßa-feira, o agente Jo√£o Pereira fica na sede para acolhimento.",
                quarta: "Na quarta-feira, o agente Paulo Souza fica na sede para acolhimento.",
                quinta: "Na quinta-feira, a agente Ana Costa fica na sede para acolhimento.",
                sexta: "Na sexta-feira, a agente Maria Silva fica na sede para acolhimento.",
                sandra: "Sandra √© uma agente de sa√∫de.",
                debora: "D√©bora √© uma agente de sa√∫de.",
                richard: "Richard √© um agente de sa√∫de.",
                doca: "Doca √© uma agente de sa√∫de."
            },
            
            // Informa√ß√µes sobre o SUS
            sus: {
                definicao: "O SUS √© o Sistema √önico de Sa√∫de, criado para garantir o acesso gratuito e universal √† sa√∫de no Brasil.",
                criacao: "O SUS foi criado em 1988 pela Constitui√ß√£o Federal.",
                objetivo: "Oferecer atendimento integral, universal e gratuito √† popula√ß√£o brasileira.",
                principios: "Os princ√≠pios do SUS s√£o: universalidade, integralidade e equidade.",
                acesso: "Todos os cidad√£os brasileiros t√™m direito ao SUS.",
                atencaoPrimaria: "A Aten√ß√£o Prim√°ria √© a porta de entrada do SUS, que cuida da preven√ß√£o e acompanhamento da sa√∫de.",
                usf: "USF significa Unidade de Sa√∫de da Fam√≠lia, um servi√ßo b√°sico do SUS que atende a popula√ß√£o local.",
                financiamento: "O SUS √© financiado por recursos p√∫blicos das esferas federal, estadual e municipal.",
                servicos: "O SUS oferece atendimento b√°sico, exames, consultas, emerg√™ncias, cirurgias, entre outros.",
                vacinacao: "Sim, o SUS √© respons√°vel pela vacina√ß√£o em todo o Brasil.",
                doencasCronicas: "Sim, o acompanhamento de doen√ßas cr√¥nicas faz parte do SUS.",
                profissionais: "Os profissionais da USF s√£o respons√°veis pela promo√ß√£o, preven√ß√£o e tratamento b√°sico de sa√∫de.",
                gratuito: "Sim, todos os servi√ßos do SUS s√£o gratuitos para a popula√ß√£o.",
                atendimento: "As equipes da USF fazem atendimentos na unidade e na resid√™ncia dos pacientes.",
                integralidade: "Integralidade no SUS √© a oferta de servi√ßos que consideram a pessoa em todas as suas necessidades."
            },
            
            // Informa√ß√µes sobre SISREG
            sisreg: {
                definicao: "O SISREG √© um sistema web criado pelo Minist√©rio da Sa√∫de para gerenciar a regula√ß√£o do acesso a consultas, exames e procedimentos na rede p√∫blica de sa√∫de, otimizando recursos e organizando o fluxo de atendimento com muito cuidado.",
                modulos: "O SISREG possui dois m√≥dulos principais: o m√≥dulo Ambulatorial, que regula consultas, exames e Servi√ßos Auxiliares de Diagn√≥stico e Terapia, e o m√≥dulo Hospitalar, que regula interna√ß√µes hospitalares.",
                funcao: "O sistema controla o agendamento e a lista de espera, gerenciando a oferta e demanda dos servi√ßos de sa√∫de, garantindo organiza√ß√£o e prioriza√ß√£o dos pacientes conforme a necessidade cl√≠nica, sempre com aten√ß√£o ao bem-estar de cada pessoa.",
                usuarios: "O SISREG √© utilizado por profissionais da sa√∫de, gestores e operadores das Centrais de Regula√ß√£o, que s√£o treinados e cadastrados para manter o sistema atualizado e funcionando com efici√™ncia para melhor atender voc√™.",
                obrigatoriedade: "O uso do SISREG √© gratuito e oficial para a regula√ß√£o no SUS, mas sua implanta√ß√£o depende de ades√£o formal dos gestores municipais ou estaduais de sa√∫de."
            },
            
            // Informa√ß√µes sobre USF Apipucos
            usfApipucos: {
                definicao: "A USF Apipucos √© uma unidade b√°sica de sa√∫de que faz parte da Aten√ß√£o Prim√°ria do SUS no bairro Apipucos.",
                funcao: "Promover a sa√∫de, prevenir doen√ßas e acompanhar os pacientes da comunidade.",
                profissionais: "Na USF Apipucos atuam m√©dicos, enfermeiros, dentistas, agentes comunit√°rios e outros profissionais da sa√∫de.",
                gestantes: "Sim, a USF Apipucos acompanha o pr√©-natal e cuidados durante a gesta√ß√£o.",
                faixasEtarias: "Sim, oferece cuidado especial para todas as faixas et√°rias, crian√ßas e idosos.",
                vacinacao: "Sim, a USF Apipucos √© um dos locais de vacina√ß√£o da comunidade.",
                contribuicao: "A USF Apipucos contribui atendendo a popula√ß√£o local com a√ß√µes preventivas e tratamentos b√°sicos.",
                acoes: "Realizamos consultas, vacina√ß√£o, pr√©-natal, acompanhamento de diabetes e hipertens√£o.",
                agente: "O agente comunit√°rio de sa√∫de visita as fam√≠lias e faz encaminhamentos para a equipe da unidade.",
                pandemia: "A USF Apipucos ajuda realizando testes, orienta√ß√µes e acompanhamento dos casos.",
                educacao: "Sim, promovemos palestras e atividades educativas para a comunidade.",
                bairro: "Sim, Apipucos √© um bairro hist√≥rico de Recife, com ra√≠zes ind√≠genas, coloniais e desenvolvimento industrial.",
                importancia: "O SUS √© fundamental porque leva sa√∫de p√∫blica e atendimento b√°sico humanizado para toda a popula√ß√£o."
            },
            
            // Informa√ß√µes de sa√∫de e doen√ßas
            saude: {
                hipertensao: "A hipertens√£o √© quando a press√£o do sangue fica alta, e cuidar dela ajuda seu cora√ß√£o a ficar forte e saud√°vel.",
                prevencaoHipertensao: "Comer saud√°vel, praticar exerc√≠cios e evitar o excesso de sal fazem um √≥timo trabalho para manter sua press√£o equilibrada.",
                diabetes: "Diabetes √© quando o corpo tem dificuldade em usar o a√ß√∫car do sangue, mas com cuidados e acompanhamento, voc√™ pode viver bem.",
                sintomasDiabetes: "Fique atento a muita sede, fome e vontade de urinar. Se perceber isso, procure nossa ajuda.",
                controleDiabetes: "Com alimenta√ß√£o especial, atividade f√≠sica e seguindo orienta√ß√µes m√©dicas, voc√™ vai se cuidar muito bem.",
                asma: "A asma √© uma condi√ß√£o que pode deixar a respira√ß√£o mais dif√≠cil, mas com tratamento certo voc√™ pode levar uma vida tranquila.",
                criseAsma: "Respire devagar, use seu medicamento e, se precisar, venha r√°pido √† nossa unidade.",
                lombalgia: "A lombalgia pode vir do esfor√ßo, postura ou estresse, mas temos jeitos gentis de aliviar sua dor.",
                dorCostas: "Alongamento, exerc√≠cios e repouso ajudam bastante, e aqui ensinamos tudo com carinho.",
                tuberculose: "√â uma infec√ß√£o que afeta os pulm√µes, mas com tratamento correto na USF voc√™ ficar√° bem rapidinho.",
                prevencaoTuberculose: "Vacina√ß√£o e evitar contato com pessoas doentes ajudam muito.",
                hanseniase: "√â uma doen√ßa que precisa de tratamento especial, que fornecemos na USF.",
                detectarHanseniase: "Manchas na pele e sensibilidade diferente s√£o sinais importantes que avaliamos com cuidado.",
                infeccaoUrinaria: "√â quando o xixi incomoda, mas com rem√©dio e hidrata√ß√£o voc√™ melhora rapidinho.",
                evitarInfeccaoUrinaria: "Beber √°gua, ir ao banheiro quando sentir vontade e higiene s√£o gestos simples que ajudam.",
                vacinas: "Muitas vacinas importantes para voc√™ e sua fam√≠lia est√£o dispon√≠veis aqui.",
                saudeMental: "Aqui voc√™ tem um espa√ßo seguro para conversar e receber apoio com muita gentileza.",
                colesterol: "O colesterol controlado ajuda seu cora√ß√£o a funcionar melhor, prevenindo doen√ßas.",
                dengue: "Dengue √© uma doen√ßa transmitida por mosquitos, prevenimos mantendo √°gua limpa e evitando focos.",
                febre: "Se a febre aparecer, descanse bastante e, se precisar, venha at√© a USF.",
                dorGarganta: "Se a dor n√£o passar em alguns dias ou vier com febre, nossa equipe est√° aqui para ajudar.",
                ferimentos: "Aqui ensinamos como cuidar com carinho, e realizamos curativos para sua seguran√ßa.",
                diabetesGestacional: "√â uma forma de diabetes que pode aparecer na gravidez, monitoramos para mam√£e e beb√™ ficarem saud√°veis.",
                pararFumar: "Temos programas especiais para ajudar voc√™ a conquistar uma vida mais saud√°vel.",
                agendamento: "√â f√°cil e r√°pido! Voc√™ pode ligar ou vir at√© aqui, estamos prontos para atender.",
                atividadeFisica: "Movimentar-se deixa o corpo forte e a mente feliz, incentivamos voc√™ com carinho.",
                dst: "Usar preservativo e fazer exames regulares s√£o cuidados importantes para sua sa√∫de √≠ntima.",
                prenatal: "O pr√©-natal cuida da sa√∫de da mam√£e e do beb√™, garantindo uma gravidez tranquila.",
                exames: "Muitos exames b√°sicos para cuidar da sua sa√∫de est√£o dispon√≠veis aqui.",
                gravidez: "Estamos aqui para acolher voc√™ e realizar o teste r√°pido, cuidando com muito carinho.",
                alimentacao: "Comer alimentos variados e coloridos ajuda seu corpo a ficar forte.",
                saudeBucal: "Cuidar dos dentes e gengivas √© essencial, temos profissionais para seu sorriso ficar saud√°vel.",
                ansiedade: "Entendemos seu sentimento e aqui temos acolhimento especial para ouvir voc√™.",
                medicamentos: "Nossa equipe explica tudo com paci√™ncia para que voc√™ use os rem√©dios da melhor forma.",
                quedas: "Deixar o ambiente organizado e com boa ilumina√ß√£o ajuda a evitar acidentes.",
                receberRemedio: "Ap√≥s a consulta, entregamos os medicamentos indicados, com todo cuidado.",
                cancerColo: "√â um tipo de c√¢ncer preven√≠vel com exames regulares, fazemos esse acompanhamento.",
                papanicolau: "√â um exame simples e r√°pido, feito aqui com muito respeito e cuidado.",
                depressao: "Depress√£o √© quando a tristeza fica prolongada, mas com ajuda e tratamento podemos melhorar sua qualidade de vida.",
                emergencias: "Cuidamos de pequenas urg√™ncias com aten√ß√£o e, se precisar, encaminhamos para o servi√ßo adequado."
            }
        };

        // Fun√ß√£o para inicializar o reconhecimento de voz
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = 'pt-BR';
                recognition.continuous = true;
                recognition.interimResults = false;
                
                recognition.onstart = function() {
                    updateStatus('listening', 'Ouvindo...');
                };
                
                recognition.onresult = function(event) {
                    const transcript = event.results[event.results.length - 1][0].transcript.toLowerCase().trim();
                    
                    // Verifica se foi dito "oi flor" para ativar
                    if (transcript.includes('oi flor') || transcript.includes('ol√° flor')) {
                        speak("Oi! Como posso ajud√°-lo hoje? Estou aqui para orient√°-lo com todo carinho sobre nossos servi√ßos.");
                        addMessage('Flor', 'Oi! Como posso ajud√°-lo hoje? Estou aqui para orient√°-lo com todo carinho sobre nossos servi√ßos.', 'bot');
                        return;
                    }
                    
                    // Se est√° no modo de escuta cont√≠nua, processa a pergunta
                    if (continuousListening || transcript.includes('oi flor')) {
                        addMessage('Voc√™', transcript, 'user');
                        const response = processQuestion(transcript);
                        setTimeout(() => {
                            addMessage('Flor', response, 'bot');
                            speak(response);
                        }, 500);
                    }
                };
                
                recognition.onerror = function(event) {
                    console.error('Erro no reconhecimento de voz:', event.error);
                    updateStatus('online', 'Online');
                };
                
                recognition.onend = function() {
                    if (continuousListening) {
                        recognition.start();
                    } else {
                        updateStatus('online', 'Online');
                        updateVoiceButton(false);
                    }
                };
            }
        }

        // Fun√ß√£o para processar perguntas e gerar respostas
        function processQuestion(question) {
            const q = question.toLowerCase();
            
            // Sauda√ß√µes
            if (q.includes('oi') || q.includes('ol√°') || q.includes('bom dia') || q.includes('boa tarde') || q.includes('boa noite')) {
                return "Ol√°! Seja muito bem-vindo(a) √† USF Apipucos! Eu sou a Flor, sua assistente virtual. Estou aqui para orient√°-lo(a) com carinho sobre nossos servi√ßos de sa√∫de. Como posso ajud√°-lo(a) hoje?";
            }
            
            // Agradecimentos
            if (q.includes('obrigad') || q.includes('valeu') || q.includes('tchau') || q.includes('at√© logo')) {
                return "De nada! Foi um prazer ajud√°-lo. Tenha um √≥timo dia e cuide-se bem!";
            }
            
            // Informa√ß√µes espec√≠ficas da equipe
            if (q.includes('clariana') || q.includes('dra clariana') || q.includes('doutora clariana')) {
                return knowledge.equipeEspecifica.clariana;
            }
            
            if (q.includes('preven√ß√£o') || q.includes('preventivo')) {
                return knowledge.equipeEspecifica.clariana;
            }
            
            if (q.includes('regulamento') || q.includes('quem faz regulamento') || q.includes('jorge')) {
                return knowledge.equipeEspecifica.jorge;
            }
            
            if (q.includes('vigia') || q.includes('seguran√ßa') || q.includes('wellington')) {
                return knowledge.equipeEspecifica.wellington;
            }
            
            if (q.includes('m√©dico da manh√£') || q.includes('m√©dico de manh√£') || q.includes('rubens') || q.includes('dr rubens')) {
                return knowledge.equipeEspecifica.rubens;
            }
            
            // Agentes de sa√∫de para acolhimento
            if (q.includes('agente') || q.includes('acolhimento') || q.includes('agente de sa√∫de')) {
                if (q.includes('segunda') || q.includes('segunda-feira')) {
                    return knowledge.agentesAcolhimento.segunda;
                } else if (q.includes('ter√ßa') || q.includes('ter√ßa-feira')) {
                    return knowledge.agentesAcolhimento.terca;
                } else if (q.includes('quarta') || q.includes('quarta-feira')) {
                    return knowledge.agentesAcolhimento.quarta;
                } else if (q.includes('quinta') || q.includes('quinta-feira')) {
                    return knowledge.agentesAcolhimento.quinta;
                } else if (q.includes('sexta') || q.includes('sexta-feira')) {
                    return knowledge.agentesAcolhimento.sexta;
                } else if (q.includes('quem faz') || q.includes('quem √© respons√°vel')) {
                    return knowledge.agentesAcolhimento.geral;
                } else {
                    return `${knowledge.agentesAcolhimento.geral} Temos agentes todos os dias: Segunda: Doca, Ter√ßa: Jo√£o Pereira, Quarta: Paulo Souza, Quinta: Ana Costa, Sexta: Maria Silva.`;
                }
            }
            
            // Nomes espec√≠ficos dos agentes
            if (q.includes('doca')) {
                return knowledge.agentesAcolhimento.segunda;
            }
            if (q.includes('jo√£o pereira') || q.includes('joao pereira')) {
                return knowledge.agentesAcolhimento.terca;
            }
            if (q.includes('paulo souza')) {
                return knowledge.agentesAcolhimento.quarta;
            }
            if (q.includes('ana costa')) {
                return knowledge.agentesAcolhimento.quinta;
            }
            if (q.includes('maria silva')) {
                return knowledge.agentesAcolhimento.sexta;
            }
            
            // Informa√ß√µes sobre pessoas espec√≠ficas
            if (q.includes('fernando rocha') || q.includes('fernando')) {
                return knowledge.equipeEspecifica.fernando;
            }
            
            if (q.includes('gestora') || q.includes('niedja')) {
                return knowledge.equipeEspecifica.niedja;
            }
            
            // Servi√ßos espec√≠ficos e localiza√ß√£o
            if (q.includes('vacina') && (q.includes('onde') || q.includes('aonde') || q.includes('local'))) {
                return knowledge.equipeEspecifica.carmem;
            }
            
            if (q.includes('coleta de sangue') || q.includes('coleta') && q.includes('sangue')) {
                return knowledge.equipeEspecifica.carmem;
            }
            
            if (q.includes('carmen') || q.includes('dra carmen') || q.includes('doutora carmen')) {
                return knowledge.equipeEspecifica.carmem;
            }
            
            if (q.includes('dentista') || q.includes('atendimento dentista') || q.includes('dental')) {
                return knowledge.equipeEspecifica.loala;
            }
            
            if (q.includes('loala') || q.includes('dra loala') || q.includes('cirurgi√£ dentista')) {
                return knowledge.equipeEspecifica.loala;
            }
            
            if (q.includes('cl√≠nico geral') && (q.includes('tarde') || q.includes('√† tarde'))) {
                return knowledge.equipeEspecifica.marcos;
            }
            
            if (q.includes('marcos augusto') || q.includes('dr marcos') || q.includes('marcos')) {
                return knowledge.equipeEspecifica.marcos;
            }
            
            // Perguntas espec√≠ficas sobre acolhimento
            if (q.includes('quem faz acolhimento') || q.includes('quem √© respons√°vel pelo acolhimento')) {
                return knowledge.agentesAcolhimento.geral;
            }
            
            // Agentes de sa√∫de espec√≠ficos
            if (q.includes('sandra')) {
                return knowledge.agentesAcolhimento.sandra;
            }
            if (q.includes('d√©bora') || q.includes('debora')) {
                return knowledge.agentesAcolhimento.debora;
            }
            if (q.includes('richard')) {
                return knowledge.agentesAcolhimento.richard;
            }
            if (q.includes('doca') && !q.includes('segunda')) {
                return knowledge.agentesAcolhimento.doca;
            }
            
            // Perguntas sobre o SUS
            if (q.includes('o que √© o sus') || q.includes('sus') && q.includes('o que √©')) {
                return knowledge.sus.definicao;
            }
            if (q.includes('quando o sus foi criado') || q.includes('cria√ß√£o do sus')) {
                return knowledge.sus.criacao;
            }
            if (q.includes('objetivo') && q.includes('sus')) {
                return knowledge.sus.objetivo;
            }
            if (q.includes('princ√≠pios') && q.includes('sus')) {
                return knowledge.sus.principios;
            }
            if (q.includes('quem pode ter acesso') && q.includes('sus')) {
                return knowledge.sus.acesso;
            }
            if (q.includes('aten√ß√£o prim√°ria') || q.includes('atencao primaria')) {
                return knowledge.sus.atencaoPrimaria;
            }
            if (q.includes('o que √© usf') || q.includes('usf') && q.includes('o que √©')) {
                return knowledge.sus.usf;
            }
            if (q.includes('financiado') && q.includes('sus')) {
                return knowledge.sus.financiamento;
            }
            if (q.includes('servi√ßos') && q.includes('sus')) {
                return knowledge.sus.servicos;
            }
            if (q.includes('campanha') && q.includes('vacina√ß√£o')) {
                return knowledge.sus.vacinacao;
            }
            if (q.includes('doen√ßas cr√¥nicas') && q.includes('sus')) {
                return knowledge.sus.doencasCronicas;
            }
            if (q.includes('papel') && q.includes('profissionais')) {
                return knowledge.sus.profissionais;
            }
            if (q.includes('sus √© gratuito') || q.includes('gratuito') && q.includes('sus')) {
                return knowledge.sus.gratuito;
            }
            if (q.includes('integralidade') && q.includes('sus')) {
                return knowledge.sus.integralidade;
            }
            
            // Perguntas sobre USF Apipucos
            if (q.includes('o que √© a usf apipucos') || q.includes('usf apipucos') && q.includes('o que √©')) {
                return knowledge.usfApipucos.definicao;
            }
            if (q.includes('fun√ß√£o') && q.includes('usf apipucos')) {
                return knowledge.usfApipucos.funcao;
            }
            if (q.includes('profissionais') && q.includes('usf apipucos')) {
                return knowledge.usfApipucos.profissionais;
            }
            if (q.includes('gestante') && q.includes('usf apipucos')) {
                return knowledge.usfApipucos.gestantes;
            }
            if (q.includes('crian√ßas') && q.includes('idosos')) {
                return knowledge.usfApipucos.faixasEtarias;
            }
            if (q.includes('vacina√ß√£o') && q.includes('usf apipucos')) {
                return knowledge.usfApipucos.vacinacao;
            }
            if (q.includes('contribui') && q.includes('sus')) {
                return knowledge.usfApipucos.contribuicao;
            }
            if (q.includes('a√ß√µes de sa√∫de')) {
                return knowledge.usfApipucos.acoes;
            }
            if (q.includes('agente comunit√°rio')) {
                return knowledge.usfApipucos.agente;
            }
            if (q.includes('pandemia')) {
                return knowledge.usfApipucos.pandemia;
            }
            if (q.includes('educa√ß√£o') && q.includes('sa√∫de')) {
                return knowledge.usfApipucos.educacao;
            }
            if (q.includes('bairro apipucos') && q.includes('hist√≥ria')) {
                return knowledge.usfApipucos.bairro;
            }
            
            // Perguntas sobre sa√∫de e doen√ßas
            if (q.includes('hipertens√£o') && (q.includes('o que √©') || q.includes('arterial'))) {
                return knowledge.saude.hipertensao;
            }
            if (q.includes('prevenir') && q.includes('hipertens√£o')) {
                return knowledge.saude.prevencaoHipertensao;
            }
            if (q.includes('diabetes') && q.includes('o que √©')) {
                return knowledge.saude.diabetes;
            }
            if (q.includes('sintomas') && q.includes('diabetes')) {
                return knowledge.saude.sintomasDiabetes;
            }
            if (q.includes('controlar') && q.includes('diabetes')) {
                return knowledge.saude.controleDiabetes;
            }
            if (q.includes('asma') && q.includes('o que √©')) {
                return knowledge.saude.asma;
            }
            if (q.includes('crise') && q.includes('asma')) {
                return knowledge.saude.criseAsma;
            }
            if (q.includes('lombalgia') || (q.includes('dor') && q.includes('costas') && q.includes('causas'))) {
                return knowledge.saude.lombalgia;
            }
            if (q.includes('tratar') && q.includes('dor') && q.includes('costas')) {
                return knowledge.saude.dorCostas;
            }
            if (q.includes('tuberculose') && q.includes('o que √©')) {
                return knowledge.saude.tuberculose;
            }
            if (q.includes('prevenir') && q.includes('tuberculose')) {
                return knowledge.saude.prevencaoTuberculose;
            }
            if (q.includes('hansen√≠ase') && q.includes('o que √©')) {
                return knowledge.saude.hanseniase;
            }
            if (q.includes('detectar') && q.includes('hansen√≠ase')) {
                return knowledge.saude.detectarHanseniase;
            }
            if (q.includes('infec√ß√£o urin√°ria')) {
                return knowledge.saude.infeccaoUrinaria;
            }
            if (q.includes('evitar') && q.includes('infec√ß√£o urin√°ria')) {
                return knowledge.saude.evitarInfeccaoUrinaria;
            }
            if (q.includes('vacinas') && (q.includes('posso') || q.includes('tomar'))) {
                return knowledge.saude.vacinas;
            }
            if (q.includes('sa√∫de mental')) {
                return knowledge.saude.saudeMental;
            }
            if (q.includes('colesterol')) {
                return knowledge.saude.colesterol;
            }
            if (q.includes('dengue')) {
                return knowledge.saude.dengue;
            }
            if (q.includes('febre')) {
                return knowledge.saude.febre;
            }
            if (q.includes('dor de garganta')) {
                return knowledge.saude.dorGarganta;
            }
            if (q.includes('ferimentos')) {
                return knowledge.saude.ferimentos;
            }
            if (q.includes('diabetes gestacional')) {
                return knowledge.saude.diabetesGestacional;
            }
            if (q.includes('parar de fumar')) {
                return knowledge.saude.pararFumar;
            }
            if (q.includes('atividade f√≠sica')) {
                return knowledge.saude.atividadeFisica;
            }
            if (q.includes('doen√ßas sexualmente')) {
                return knowledge.saude.dst;
            }
            if (q.includes('pr√©-natal')) {
                return knowledge.saude.prenatal;
            }
            if (q.includes('exames') && q.includes('posso fazer')) {
                return knowledge.saude.exames;
            }
            if (q.includes('suspeita') && q.includes('gravidez')) {
                return knowledge.saude.gravidez;
            }
            if (q.includes('alimenta√ß√£o')) {
                return knowledge.saude.alimentacao;
            }
            if (q.includes('sa√∫de bucal')) {
                return knowledge.saude.saudeBucal;
            }
            if (q.includes('ansiedade')) {
                return knowledge.saude.ansiedade;
            }
            if (q.includes('medicamentos') && q.includes('d√∫vidas')) {
                return knowledge.saude.medicamentos;
            }
            if (q.includes('quedas')) {
                return knowledge.saude.quedas;
            }
            if (q.includes('receber rem√©dios')) {
                return knowledge.saude.receberRemedio;
            }
            if (q.includes('c√¢ncer') && q.includes('colo')) {
                return knowledge.saude.cancerColo;
            }
            if (q.includes('papanicolau')) {
                return knowledge.saude.papanicolau;
            }
            if (q.includes('depress√£o')) {
                return knowledge.saude.depressao;
            }
            if (q.includes('emerg√™ncias') && q.includes('usf')) {
                return knowledge.saude.emergencias;
            }
            
            // Perguntas sobre SISREG
            if (q.includes('sisreg') && (q.includes('o que √©') || q.includes('sistema'))) {
                return knowledge.sisreg.definicao;
            }
            if (q.includes('m√≥dulos') && q.includes('sisreg')) {
                return knowledge.sisreg.modulos;
            }
            if (q.includes('serve') && q.includes('sisreg')) {
                return knowledge.sisreg.funcao;
            }
            if (q.includes('quem pode utilizar') && q.includes('sisreg')) {
                return knowledge.sisreg.usuarios;
            }
            if (q.includes('obrigat√≥rio') && q.includes('sisreg')) {
                return knowledge.sisreg.obrigatoriedade;
            }
            if (q.includes('sisreg') && (q.includes('como funciona') || q.includes('utiliza√ß√£o'))) {
                return knowledge.sisreg.funcao;
            }
            
            // Autoridades e administra√ß√£o
            if (q.includes('diretor') && (q.includes('terceiro distrito') || q.includes('3¬∫ distrito'))) {
                return knowledge.equipeEspecifica.bruno;
            }
            
            if (q.includes('bruno de luna') || q.includes('bruno')) {
                return knowledge.equipeEspecifica.bruno;
            }
            
            if (q.includes('prefeito') || (q.includes('prefeito') && q.includes('recife'))) {
                return knowledge.equipeEspecifica.joao;
            }
            
            if (q.includes('jo√£o campos') || q.includes('joao campos')) {
                return knowledge.equipeEspecifica.joao;
            }
            
            // M√©dicos residentes
            if (q.includes('m√©dicos residentes') || q.includes('residentes') || q.includes('m√©dico residente')) {
                return knowledge.equipeEspecifica.residentes;
            }
            
            if (q.includes('sabrina') || q.includes('dra sabrina') || q.includes('doutora sabrina')) {
                return "Dra. Sabrina √© uma das m√©dicas residentes da USF Apipucos.";
            }
            
            if (q.includes('felipe') && (q.includes('residente') || q.includes('dr felipe residente'))) {
                return "Dr. Felipe √© um dos m√©dicos residentes da USF Apipucos.";
            }
            
            // Endere√ßo
            if (q.includes('endere√ßo') || q.includes('onde fica') || q.includes('localiza√ß√£o') || q.includes('local')) {
                return `A USF Apipucos fica no endere√ßo: ${knowledge.endereco}`;
            }
            
            // Telefone
            if (q.includes('telefone') || q.includes('contato') || q.includes('ligar')) {
                return `Voc√™ pode entrar em contato conosco pelo telefone ${knowledge.telefone}`;
            }
            
            // Hor√°rio de funcionamento
            if (q.includes('hor√°rio') || q.includes('hora') || q.includes('funcionamento') || q.includes('abre') || q.includes('fecha')) {
                return `Nosso hor√°rio de funcionamento √©: ${knowledge.horario}`;
            }
            
            // Servi√ßos
            if (q.includes('servi√ßos') || q.includes('servi√ßo') || q.includes('atende') || q.includes('oferece') || q.includes('faz')) {
                return `Oferecemos os seguintes servi√ßos: ${knowledge.servicos.join(', ')}.`;
            }
            
            // M√©dicos
            if (q.includes('m√©dico') || q.includes('doutor') || q.includes('cl√≠nico') || q.includes('pediatra')) {
                if (q.includes('primeiro turno') || q.includes('manh√£')) {
                    return `M√©dicos do primeiro turno (manh√£): ${knowledge.medicos.primeiro}`;
                } else if (q.includes('segundo turno') || q.includes('tarde')) {
                    return `M√©dicos do segundo turno (tarde): ${knowledge.medicos.segundo}`;
                } else {
                    return `Nossos m√©dicos trabalham em dois turnos: Manh√£: ${knowledge.medicos.primeiro}. Tarde: ${knowledge.medicos.segundo}`;
                }
            }
            
            // Equipes por dia da semana
            if (q.includes('segunda') || q.includes('segunda-feira')) {
                return `Equipe de segunda-feira: ${knowledge.equipes.segunda}`;
            }
            if (q.includes('ter√ßa') || q.includes('ter√ßa-feira')) {
                return `Equipe de ter√ßa-feira: ${knowledge.equipes.terca}`;
            }
            if (q.includes('quarta') || q.includes('quarta-feira')) {
                return `Equipe de quarta-feira: ${knowledge.equipes.quarta}`;
            }
            if (q.includes('quinta') || q.includes('quinta-feira')) {
                return `Equipe de quinta-feira: ${knowledge.equipes.quinta}`;
            }
            if (q.includes('sexta') || q.includes('sexta-feira')) {
                return `Equipe de sexta-feira: ${knowledge.equipes.sexta}`;
            }
            
            // Exames
            if (q.includes('exame') || q.includes('coleta') || q.includes('sangue') || q.includes('urina')) {
                return `Realizamos exames ${knowledge.exames.horario}. Tipos de exames: ${knowledge.exames.tipos.join(', ')}. Documentos necess√°rios: ${knowledge.exames.documentos}.`;
            }
            
            // Vacina√ß√£o
            if (q.includes('vacina') || q.includes('vacina√ß√£o') || q.includes('imuniza√ß√£o')) {
                return `Vacina√ß√£o acontece ${knowledge.vacinacao.dias}. Vacinas dispon√≠veis: ${knowledge.vacinacao.tipos.join(', ')}. Traga: ${knowledge.vacinacao.documentos}.`;
            }
            
            // Agendamento
            if (q.includes('agendar') || q.includes('agendamento') || q.includes('marcar') || q.includes('consulta')) {
                return `Para agendar: ${knowledge.agendamento.como}. Hor√°rio de agendamento: ${knowledge.agendamento.horario}. Documentos necess√°rios: ${knowledge.agendamento.documentos}. Chegue com ${knowledge.agendamento.chegada}.`;
            }
            
            // Email
            if (q.includes('email') || q.includes('e-mail')) {
                return `Nosso email √©: ${knowledge.email}`;
            }
            
            // Resposta padr√£o
            return "Desculpe, n√£o entendi sua pergunta. Voc√™ pode perguntar sobre hor√°rios, servi√ßos, endere√ßo, telefone, m√©dicos, agendamentos, exames ou vacina√ß√£o. Como posso ajud√°-lo?";
        }

        // Fun√ß√£o para adicionar mensagem ao chat
        function addMessage(sender, text, type) {
            const messages = document.getElementById('messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            messageDiv.innerHTML = `
                <div class="message-sender">${sender}</div>
                <div class="message-content">${text}</div>
            `;
            
            messages.appendChild(messageDiv);
            messages.scrollTop = messages.scrollHeight;
        }

        // Fun√ß√£o para falar texto com voz feminina otimizada
        function speak(text) {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'pt-BR';
            
            // Configura√ß√µes para voz feminina mais natural
            utterance.rate = 0.85;  // Velocidade um pouco mais lenta para clareza
            utterance.pitch = 1.3;  // Tom mais agudo (feminino)
            utterance.volume = 0.9; // Volume ligeiramente reduzido para suavidade
            
            // Tenta selecionar uma voz feminina em portugu√™s
            const voices = speechSynthesis.getVoices();
            const femaleVoice = voices.find(voice => 
                voice.lang.includes('pt') && 
                (voice.name.toLowerCase().includes('female') || 
                 voice.name.toLowerCase().includes('feminina') ||
                 voice.name.toLowerCase().includes('woman') ||
                 voice.name.toLowerCase().includes('maria') ||
                 voice.name.toLowerCase().includes('ana') ||
                 voice.name.toLowerCase().includes('lucia'))
            );
            
            // Se n√£o encontrar voz feminina espec√≠fica, usa a primeira voz portuguesa dispon√≠vel
            const portugueseVoice = voices.find(voice => 
                voice.lang.includes('pt-BR') || voice.lang.includes('pt')
            );
            
            if (femaleVoice) {
                utterance.voice = femaleVoice;
            } else if (portugueseVoice) {
                utterance.voice = portugueseVoice;
            }
            
            speechSynthesis.speak(utterance);
            currentUtterance = utterance;
        }

        // Fun√ß√£o para enviar mensagem
        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Adiciona mensagem do usu√°rio
            addMessage('Voc√™', message, 'user');
            input.value = '';
            
            // Mostra indicador de digita√ß√£o
            showTypingIndicator();
            
            // Processa resposta ap√≥s um pequeno delay
            setTimeout(() => {
                hideTypingIndicator();
                const response = processQuestion(message);
                addMessage('Flor', response, 'bot');
                speak(response);
            }, 1000);
        }

        // Fun√ß√£o para lidar com teclas pressionadas
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Fun√ß√£o para fazer pergunta r√°pida
        function askQuestion(question) {
            document.getElementById('userInput').value = question;
            sendMessage();
        }

        // Fun√ß√£o para alternar reconhecimento de voz
        function toggleVoiceRecognition() {
            if (!recognition) {
                alert('Reconhecimento de voz n√£o suportado neste navegador.');
                return;
            }
            
            if (isListening) {
                recognition.stop();
                continuousListening = false;
                updateVoiceButton(false);
                updateStatus('online', 'Online');
            } else {
                recognition.start();
                continuousListening = true;
                updateVoiceButton(true);
            }
        }

        // Fun√ß√£o para atualizar bot√£o de voz
        function updateVoiceButton(listening) {
            const btn = document.getElementById('voiceBtn');
            const icon = document.getElementById('voiceIcon');
            const text = document.getElementById('voiceText');
            
            if (listening) {
                btn.classList.add('listening');
                icon.textContent = '‚èπÔ∏è';
                text.textContent = 'Parar';
                isListening = true;
            } else {
                btn.classList.remove('listening');
                icon.textContent = 'üé§';
                text.textContent = 'Ativar Voz';
                isListening = false;
            }
        }

        // Fun√ß√£o para atualizar status
        function updateStatus(status, text) {
            const indicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            indicator.className = `status-indicator ${status}`;
            statusText.textContent = text;
        }

        // Fun√ß√£o para mostrar indicador de digita√ß√£o
        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'flex';
        }

        // Fun√ß√£o para esconder indicador de digita√ß√£o
        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        // Fun√ß√£o para lidar com upload de logos
        function handleLogoUpload(input, placeholderId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const placeholder = document.getElementById(placeholderId);
                    placeholder.innerHTML = '<img src="' + e.target.result + '" alt="Logo">';
                    placeholder.classList.add('has-logo');
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Fun√ß√£o para carregar vozes quando estiverem dispon√≠veis
        function loadVoices() {
            return new Promise((resolve) => {
                let voices = speechSynthesis.getVoices();
                if (voices.length > 0) {
                    resolve(voices);
                } else {
                    speechSynthesis.addEventListener('voiceschanged', () => {
                        voices = speechSynthesis.getVoices();
                        resolve(voices);
                    });
                }
            });
        }

        // Inicializa√ß√£o quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializa reconhecimento de voz
            initSpeechRecognition();
            
            // Carrega vozes e depois exibe mensagem de boas-vindas
            loadVoices().then(() => {
                setTimeout(() => {
                    const welcomeMessage = 'Bem-vindo √† USF Apipucos! Eu sou a Flor, sua assistente virtual. Estou aqui para orient√°-lo com carinho sobre nossos servi√ßos de sa√∫de. Como posso ajud√°-lo hoje?';
                    addMessage('Flor', welcomeMessage, 'bot');
                    speak('Bem-vindo √† USF Apipucos! Eu sou a Flor, sua assistente virtual. Como posso ajud√°-lo hoje?');
                }, 1500);
            });
            
            // Foco no campo de input
            document.getElementById('userInput').focus();
        });
    </script>
</body>
</html>